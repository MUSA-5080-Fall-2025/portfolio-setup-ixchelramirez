{"title":"Lab4","markdown":{"yaml":{"title":"Lab4","author":"Ixchel Ramirez","date":"2025-11-17","format":"html"},"headingText":"Crime Analysis in Chicago","containsRefs":false,"markdown":"\n\n## Introduction\nThis lab looks into the correlation between 311 calls about street lights being out and burglaries. Lighting is often connected to people's perceptions on safety, people choose to walk a certain way at night because there are more street lights which enable them to see. I wanted to see how this perception of safety connects to burglary calls.  \n\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n\n# Load required packages\nlibrary(tidyverse)      # Data manipulation\nlibrary(sf)             # Spatial operations\nlibrary(here)           # Relative file paths\nlibrary(viridis)        # Color scales\nlibrary(terra)          # Raster operations (replaces 'raster')\nlibrary(spdep)          # Spatial dependence\nlibrary(FNN)            # Fast nearest neighbors\nlibrary(MASS)           # Negative binomial regression\nlibrary(patchwork)      # Plot composition (replaces grid/gridExtra)\nlibrary(knitr)          # Tables\nlibrary(kableExtra)     # Table formatting\nlibrary(classInt)       # Classification intervals\nlibrary(here)\nlibrary(dplyr)\nlibrary(ggplot2)\n\n\n# Spatstat split into sub-packages\nlibrary(spatstat.geom)    # Spatial geometries\nlibrary(spatstat.explore) # Spatial exploration/KDE\n\n# Set options\noptions(scipen = 999)  # No scientific notation\nset.seed(5080)         # Reproducibility\n\n# Create consistent theme for visualizations\ntheme_crime <- function(base_size = 11) {\n  theme_minimal(base_size = base_size) +\n    theme(\n      plot.title = element_text(face = \"bold\", size = base_size + 1),\n      plot.subtitle = element_text(color = \"gray30\", size = base_size - 1),\n      legend.position = \"right\",\n      panel.grid.minor = element_blank(),\n      axis.text = element_blank(),\n      axis.title = element_blank()\n    )\n}\n\n# Set as default\ntheme_set(theme_crime())\n\ncat(\"✓ All packages loaded successfully!\\n\")\ncat(\"✓ Working directory:\", getwd(), \"\\n\")\n\n```\n\nAbove section loads in necessary packages to allow for functions to run, placing this at the beginning of the document helps it remain organized. \n\n\n## Chicago Spatial Data \n```{r spatial data}\n\n# Load police districts (used for spatial cross-validation)\npoliceDistricts <- \n  st_read(\"https://data.cityofchicago.org/api/geospatial/24zt-jpfn?method=export&format=GeoJSON\") %>%\n  st_transform('ESRI:102271') %>%\n  dplyr::select(District = dist_num)\n\n# Load police beats (smaller administrative units)\npoliceBeats <- \n  st_read(\"https://data.cityofchicago.org/api/geospatial/n9it-hstw?method=export&format=GeoJSON\") %>%\n  st_transform('ESRI:102271') %>%\n  dplyr::select(Beat = beat_num)\n\n# Load Chicago boundary\nchicagoBoundary <- \n  st_read(\"https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/DATA/Chapter5/chicagoBoundary.geojson\") %>%\n  st_transform('ESRI:102271')\n\ncat(\"✓ Loaded spatial boundaries\\n\")\ncat(\"  - Police districts:\", nrow(policeDistricts), \"\\n\")\ncat(\"  - Police beats:\", nrow(policeBeats), \"\\n\")\n\n\n```\n\n##Loaded in Chicago Spatial data \nThe coordinate reference system is set to 'ESRI:102271' (Illinois State Plane East) because it minimizes distortion since all the data we are looking at is in Chicago. Additionally, since Chicago is in the US which feet as a system of measurement it removes the need to convert units and minimizes confusion and error in distance calculations.\n\n## Burglary Data\n```{r burglary data}\n\n# Load from provided data file (downloaded from Chicago open data portal)\n\nburglaries <- st_read(here(\"data\", \"burglaries.shp\"))\nburglaries <- st_transform(burglaries, crs = 'ESRI:102271')\n\n\n# Check the data\ncat(\"\\n✓ Loaded burglary data\\n\")\ncat(\"  - Number of burglaries:\", nrow(burglaries), \"\\n\")\ncat(\"  - CRS:\", st_crs(burglaries)$input, \"\\n\")\ncat(\"  - Date range:\", min(burglaries$date, na.rm = TRUE), \"to\", \n    max(burglaries$date, na.rm = TRUE), \"\\n\")\n\n\n```\nThere are 7482 burglaries in the data set and the CRS is also set to Chicago which is useful for later calculations that check distance. If the datasets used different coordinate reference systems then problems would arise later when calculating distance. It is important to understand that while there are 7482 burglaries the spatial distribution of these is likely unequal and reflects where crime is surveilled rather than only where crime occurs. \n\n## Visualize point data\n```{r visualize point data}\n\n# Simple point map\np1 <- ggplot() + \n  geom_sf(data = chicagoBoundary, fill = \"gray95\", color = \"gray60\") +\n  geom_sf(data = burglaries, color = \"#d62828\", size = 0.1, alpha = 0.4) +\n  labs(\n    title = \"Burglary Locations\",\n    subtitle = paste0(\"Chicago 2017, n = \", nrow(burglaries))\n  )\n\n# Density surface using modern syntax\np2 <- ggplot() + \n  geom_sf(data = chicagoBoundary, fill = \"gray95\", color = \"gray60\") +\n  geom_density_2d_filled(\n    data = data.frame(st_coordinates(burglaries)),\n    aes(X, Y),\n    alpha = 0.7,\n    bins = 8\n  ) +\n  scale_fill_viridis_d(\n    option = \"plasma\",\n    direction = -1,\n    guide = \"none\"  # Modern ggplot2 syntax (not guide = FALSE)\n  ) +\n  labs(\n    title = \"Density Surface\",\n    subtitle = \"Kernel density estimation\"\n  )\n\n# Combine plots using patchwork (modern approach)\np1 + p2 + \n  plot_annotation(\n    title = \"Spatial Distribution of Burglaries in Chicago\",\n    tag_levels = 'A'\n  )\n```\n\n\nBurglaries are not evenly distributed across Chicago, they are more frequent on the South Side of Chicago. There is also a high concentration on the Northeast side. The South Side of Chicago has a reputation for being dangerous which could result in an increased police presense as well as an increase in willingness to report the crimes here. \n\n## Create the Fishnet\n```{r create fishnet}\n\n# Create 500m x 500m grid\nfishnet <- st_make_grid(\n  chicagoBoundary,\n  cellsize = 500,  # 500 meters per cell\n  square = TRUE\n) %>%\n  st_sf() %>%\n  mutate(uniqueID = row_number())\n\n# Keep only cells that intersect Chicago\nfishnet <- fishnet[chicagoBoundary, ]\n\n# View basic info\ncat(\"✓ Created fishnet grid\\n\")\ncat(\"  - Number of cells:\", nrow(fishnet), \"\\n\")\ncat(\"  - Cell size:\", 500, \"x\", 500, \"meters\\n\")\ncat(\"  - Cell area:\", round(st_area(fishnet[1,])), \"square meters\\n\")\n\n```\nThe step above creates a fishnet grid which turns the point data into a grid of cells. Creating a grid provides a uniform unit of analysis so that one can aggregate counts, calculate spatial features and run regression models. Existing boundaries like neighborhoods and census tracts change which could result an added step when comparing years. Neighborhood boundaries are particularly harder to use because not everyone agrees on where a neighborhood begins and ends. While this approach helps with standardization it is harder to understand where burglaries occur (such as which neighborhood) because the grid does not delineate this. Thus, it requires a degree of familiarity with the area and where neighborhoods are to understand how social interactions influence the observations from the data. \n\n## Aggregate Burglaries to Grid\n```{r aggregate-burglaries}\n# Spatial join: which cell contains each burglary?\nburglaries_fishnet <- st_join(burglaries, fishnet, join = st_within) %>%\n  st_drop_geometry() %>%\n  group_by(uniqueID) %>%\n  summarize(countBurglaries = n())\n\n# Join back to fishnet (cells with 0 burglaries will be NA)\nfishnet <- fishnet %>%\n  left_join(burglaries_fishnet, by = \"uniqueID\") %>%\n  mutate(countBurglaries = replace_na(countBurglaries, 0))\n\n# Summary statistics\ncat(\"\\nBurglary count distribution:\\n\")\nsummary(fishnet$countBurglaries)\ncat(\"\\nCells with zero burglaries:\", \n    sum(fishnet$countBurglaries == 0), \n    \"/\", nrow(fishnet),\n    \"(\", round(100 * sum(fishnet$countBurglaries == 0) / nrow(fishnet), 1), \"%)\\n\")\n\n```\n\n\n```{r visualize-fishnet}\n#| fig-width: 8\n#| fig-height: 6\n\n# Visualize aggregated counts\nggplot() +\n  geom_sf(data = fishnet, aes(fill = countBurglaries), color = NA) +\n  geom_sf(data = chicagoBoundary, fill = NA, color = \"white\", linewidth = 1) +\n  scale_fill_viridis_c(\n    name = \"Burglaries\",\n    option = \"plasma\",\n    trans = \"sqrt\",  # Square root for better visualization of skewed data\n    breaks = c(0, 1, 5, 10, 20, 40)\n  ) +\n  labs(\n    title = \"Burglary Counts by Grid Cell\",\n    subtitle = \"500m x 500m cells, Chicago 2017\"\n  ) +\n  theme_crime()\n\n\n```\n\nBurglaries are more dispersed in the South Side and in the core of the North. The largest cluster of cells with zero burglaries is also on the South Side. \n\n\n## Kernal Density Basemap\n```{r kde-baseline}\n#| message: false\n\n# Convert burglaries to ppp (point pattern) format for spatstat\nburglaries_ppp <- as.ppp(\n  st_coordinates(burglaries),\n  W = as.owin(st_bbox(chicagoBoundary))\n)\n\n# Calculate KDE with 1km bandwidth\nkde_burglaries <- density.ppp(\n  burglaries_ppp,\n  sigma = 1000,  # 1km bandwidth\n  edge = TRUE    # Edge correction\n)\n\n# Convert to terra raster (modern approach, not raster::raster)\nkde_raster <- rast(kde_burglaries)\n\n# Extract KDE values to fishnet cells\nfishnet <- fishnet %>%\n  mutate(\n    kde_value = terra::extract(\n      kde_raster,\n      vect(fishnet),\n      fun = mean,\n      na.rm = TRUE\n    )[, 2]  # Extract just the values column\n  )\n\ncat(\"✓ Calculated KDE baseline\\n\")\n\n```\n\n\n```{r visualize-kde}\n#| fig-width: 8\n#| fig-height: 6\n\nggplot() +\n  geom_sf(data = fishnet, aes(fill = kde_value), color = NA) +\n  geom_sf(data = chicagoBoundary, fill = NA, color = \"white\", linewidth = 1) +\n  scale_fill_viridis_c(\n    name = \"KDE Value\",\n    option = \"plasma\"\n  ) +\n  labs(\n    title = \"Kernel Density Estimation Baseline\",\n    subtitle = \"Simple spatial smoothing of burglary locations\"\n  ) +\n  theme_crime()\n\n```\n\n\nThe above map looks very similar to the other patterns of crime in Chicago because a KDE baseline looks as what happens if an incident, in this case burglaries happens where they did before. This map counts the clusters of incidents well.\n\n## Spatial predictor variables\n```{r spatial predictor var}\n\nstreetLights_allOut <- read_csv(here(\"data/311_Service_Requests_-_Street_Lights_-_All_Out_-_Historical_20251112.csv\"))%>%\n  filter(!is.na(Latitude), !is.na(Longitude)) %>%\n  st_as_sf(coords = c(\"Longitude\", \"Latitude\"), crs = 4326) %>%\n  st_transform('ESRI:102271')\n\n#cat(\"✓ Loaded street vehicle calls\\n\")\ncat(\"  - Number of calls:\", nrow(streetLights_allOut), \"\\n\")\n\n\"data/311_Service_Requests_-_Street_Lights_-_All_Out_-_Historical_20251112.csv\"\n\n```\n\n\n## Count of Street Lights all out per cell\n```{r countstreetLights_allOut}\n# Aggregate lights out to fishnet\nlights_fishnet <- st_join(streetLights_allOut, fishnet, join = st_within) %>%\n  st_drop_geometry() %>%\n  group_by(uniqueID) %>%\n  summarize(streetLights_allOut = n())\n\n# Join to fishnet\nfishnet <- fishnet %>%\n  left_join(lights_fishnet, by = \"uniqueID\") %>%\n  mutate(streetLights_allOut = replace_na(streetLights_allOut, 0))\n\ncat(\"All lights out distribution:\\n\")\nsummary(fishnet$streetLights_allOut)\n```\n\n\n\n```{r visualize-streetlights-allout}\n#| fig-width: 10\n#| fig-height: 4\n\np1 <- ggplot() +\n  geom_sf(data = fishnet, aes(fill = streetLights_allOut), color = NA) +\n  scale_fill_viridis_c(name = \"Count\", option = \"magma\") +\n  labs(title = \"All Lights Out 311 Calls\") +\n  theme_crime()\n\np2 <- ggplot() +\n  geom_sf(data = fishnet, aes(fill = countBurglaries), color = NA) +\n  scale_fill_viridis_c(name = \"Count\", option = \"plasma\") +\n  labs(title = \"Burglaries\") +\n  theme_crime()\n\np1 + p2 +\n  plot_annotation(title = \"Are street lights out and burglaries correlated?\")\n\n```\n\n\nIn this section I pulled data from Chicago's Open Data portal for 311 calls on street lights that are all out. Visually there are similarities between where burglairies occur and where street lights are all out specifically on the South Side there is more difference between these two categories in the North. This suggests that where street lights are out could help predict burglaries, but more likely just implies perceptions of safety.\n\n## Nearest Neighbor \n\nHere we are calculating the mean distance to the 3 nearest blockw with all the lights out. \n\n```{r nn-feature}\n#| message: false\n\n# Calculate mean distance to 3 nearest lights out\n# (Do this OUTSIDE of mutate to avoid sf conflicts)\n\n# Get coordinates\nfishnet_coords <- st_coordinates(st_centroid(fishnet))\nlights_coords <- st_coordinates(streetLights_allOut)\n\n# Calculate k nearest neighbors and distances\nnn_result <- get.knnx(lights_coords, fishnet_coords, k = 3)\n\n# Add to fishnet\nfishnet <- fishnet %>%\n  mutate(\n    streetLights_allOut.nn = rowMeans(nn_result$nn.dist)\n  )\n\ncat(\"✓ Calculated nearest neighbor distances\\n\")\nsummary(fishnet$streetLights_allOut.nn)\n\n```\n\n\nA low value of streetLights_allOut.nn means means that the block is closer to other blocks with the lights out while a high value means that a cell is far from other cells with blocks that have the lights out. Blocks that have low value could indicate decreasing perceptions of safety. \n\n\n## Distance to Hot Spots\n```{r distance to hot spots}\n\n#used this for local_moran becuase when it saves fishnet as fishnet it aborts 2. dplyr mutate + sf can still corrupt the geometry column\n\ncoords <- st_coordinates(st_centroid(fishnet))\nneighbors <- knn2nb(knearneigh(coords, k = 5))\nweights <- nb2listw(neighbors, style = \"W\", zero.policy = TRUE)\n\nlocal_moran <- localmoran(fishnet[[\"streetLights_allOut\"]], weights)\nmean_val <- mean(fishnet[[\"streetLights_allOut\"]], na.rm = TRUE)\n\nfishnet$local_i <- local_moran[,1]\nfishnet$p_value <- local_moran[,5]\nfishnet$is_significant <- fishnet$p_value < 0.05\n\nmean_val <- mean(fishnet$streetLights_allOut, na.rm = TRUE)\n\nfishnet$moran_class <- dplyr::case_when(\n  !fishnet$is_significant ~ \"Not Significant\",\n  fishnet$local_i > 0 & fishnet$streetLights_allOut > mean_val ~ \"High-High\",\n  fishnet$local_i > 0 & fishnet$streetLights_allOut <= mean_val ~ \"Low-Low\",\n  fishnet$local_i < 0 & fishnet$streetLights_allOut > mean_val ~ \"High-Low\",\n  fishnet$local_i < 0 & fishnet$streetLights_allOut <= mean_val ~ \"Low-High\"\n)\n\n\n\n\n```\n\n\n```{r visualize-morans}\n#| fig-width: 8\n#| fig-height: 6\n\n# Visualize hot spots\nggplot() +\n  geom_sf(\n    data = fishnet, \n    aes(fill = moran_class), \n    color = NA\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"High-High\" = \"#d7191c\",\n      \"High-Low\" = \"#fdae61\",\n      \"Low-High\" = \"#abd9e9\",\n      \"Low-Low\" = \"#2c7bb6\",\n      \"Not Significant\" = \"gray90\"\n    ),\n    name = \"Cluster Type\"\n  ) +\n  labs(\n    title = \"Local Moran's I: Lights Out Clusters\",\n    subtitle = \"High-High = Hot spots of disorder\"\n  ) +\n  theme_crime()\n\n#fill= moran_class is not running \n\n```\n\nThe distance to a cluster of lights that are out are helpful because it shows local spatial density while only looking at the distance to one specific point could be a random incident. From the distribution there are no areas with a high-low distribution and few areas with a low-high distribution. Low-low distributions, which are cold spots few lights are out and next to people without lights out, are clustered in the Southeast corner of Chicago, with patches around the boundary of the city. This means there are low values and its surrounded by other low values. High-high clusters are in the center of Chicago suggests that the observations are part of a cluster of high values and surrounded by high values i.e. street light blocks are out and they are next to other areas with street lights that are out. One thing to keep in mind is that the boundaries of Chicago have fewer neighbors thus this could bias the results and result with the spatial outliers such as high-low results. \n\n```{r distance-to-hotspots}\n# Get centroids of \"High-High\" cells (hot spots)\nhotspots <- fishnet %>%\n  filter(moran_class == \"High-High\") %>%\n  st_centroid()\n\n# Calculate distance from each cell to nearest hot spot\nif (nrow(hotspots) > 0) {\n  fishnet <- fishnet %>%\n    mutate(\n      dist_to_hotspot = as.numeric(\n        st_distance(st_centroid(fishnet), hotspots %>% st_union())\n      )\n    )\n  \n  cat(\"✓ Calculated distance to abandoned car hot spots\\n\")\n  cat(\"  - Number of hot spot cells:\", nrow(hotspots), \"\\n\")\n} else {\n  fishnet <- fishnet %>%\n    mutate(dist_to_hotspot = 0)\n  cat(\"⚠ No significant hot spots found\\n\")\n}\n\n```\nThere are 297 hot spots.\n\n\n## Cross Validation \n```{r join-districts}\n# Join district information to fishnet\nfishnet <- st_join(\n  fishnet,\n  policeDistricts,\n  join = st_within,\n  left = TRUE\n) %>%\n  filter(!is.na(District))  # Remove cells outside districts\n\ncat(\"✓ Joined police districts\\n\")\ncat(\"  - Districts:\", length(unique(fishnet$District)), \"\\n\")\ncat(\"  - Cells:\", nrow(fishnet), \"\\n\")\n\n```\nPolice districts are used for the spatial cross-validation because we are using crime data.\n\n\n## Poisson Regression\n```{r prepare-data for Poisson}\n# Create clean modeling dataset\nfishnet_model <- fishnet %>%\n  st_drop_geometry() %>%\n  dplyr::select(\n    uniqueID,\n    District,\n    countBurglaries,\n    streetLights_allOut,\n    streetLights_allOut.nn,\n    dist_to_hotspot\n  ) %>%\n  na.omit()  # Remove any remaining NAs\n\ncat(\"✓ Prepared modeling data\\n\")\ncat(\"  - Observations:\", nrow(fishnet_model), \"\\n\")\ncat(\"  - Variables:\", ncol(fishnet_model), \"\\n\")\n\n```\nThere are 1708 observations and 6 variables. All of the values are positive because we are counting and cannot have a negative number.\n\n\n```{r poisson continued}\nfishnet_safe <- data.frame(\n  countBurglaries      = as.numeric(fishnet_model$countBurglaries),\n  streetLights_allOut  = as.numeric(fishnet_model$streetLights_allOut),\n  streetLights_allOut.nn = as.numeric(fishnet_model$streetLights_allOut.nn),\n  dist_to_hotspot      = as.numeric(fishnet_model$dist_to_hotspot)\n)\n\n# Remove row.names just in case\nrownames(fishnet_safe) <- NULL\n\n# Confirm attributes might not need attributes through glm just need to write.csv so could delete\nattributes(fishnet_safe)\n\nglm(countBurglaries ~ streetLights_allOut, data = fishnet_safe, family = poisson())\nglm(countBurglaries ~ streetLights_allOut.nn, data = fishnet_safe, family = poisson())\nglm(countBurglaries ~ dist_to_hotspot, data = fishnet_safe, family = poisson())\nglm(countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n    data = fishnet_safe, family = poisson())\n\nwrite.csv(fishnet_safe, \"fishnet_safe.csv\", row.names = FALSE)\nfishnet_reload <- read.csv(\"fishnet_safe.csv\")\n\nglm(countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n    data = fishnet_reload, family = poisson())\n\n\nlibrary(speedglm)\n\n\nmodel_poisson <- speedglm(\n  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n  data = fishnet_reload,\n  family = poisson()\n)\n\nsummary(model_poisson)\n\n```\n\nThe Poisson regression results indicate that burglary counts are significantly associated with street lighting conditions and proximity to known hotspots. Blocks with more streetlights out tend to experience slightly higher numbers of burglaries, while blocks that are farther from other lights-out blocks have lower expected burglary counts, suggesting that clusters of poorly lit areas are more vulnerable. Additionally, blocks located closer to established burglary hotspots are at greater risk. All three predictors—total street lights out (12.91), mean distance to other lights-out blocks (-19.1), and distance to hotspots (-10.72) are highly significant based on their values. The model shows that areas with less lighting are more likely to be near areas where more burglary is reported.\n\n```{r check-overdispersion}\n# Calculate dispersion parameter\ndf_resid <- nrow(fishnet_reload) - length(model_poisson$coefficients)\n\ndispersion <- model_poisson$deviance / df_resid\ndispersion\n\nif (dispersion > 1.5) {\n  cat(\"⚠ Overdispersion detected! Consider Negative Binomial model.\\n\")\n} else {\n  cat(\"✓ Dispersion looks okay for Poisson model.\\n\")\n}\n```\nOverdispersion is detected which means the variance of the response variable exceeds it's mean, which is an assumption in the Poisson distribution. \n\n## Negative Binomial Regression \n```{r fit-negbin}\n\n##ALternative way to get negative binomial regression\n\n# Fit NB using Poisson coefficients as starting values\npoisson_coefs <- coef(glm(\n  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n  data = fishnet_reload,\n  family = poisson()\n))\n\nmodel_nb <- glm.nb(\n  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n  data = fishnet_reload,\n  init.theta = 1,               # initial theta\n  control = glm.control(maxit = 100, epsilon = 1e-8),\n  start = poisson_coefs         # start from Poisson estimates\n)\nsummary(model_nb)\n\ncat(\"\\nModel Comparison:\\n\")\ncat(\"Poisson AIC:\", round(AIC(model_poisson), 1), \"\\n\")\ncat(\"Negative Binomial AIC:\", round(AIC(model_nb), 1), \"\\n\")\n\n```\n\nThe negative binomial regression results show that all three predictors are highly significant, which is consistent with the Poisson model. More streetlights out is associated with higher burglary counts, greater distance to other lights-out blocks is associated with fewer burglaries, and closer proximity to a hotspot increases burglary risk. The negative binomial model accounts for overdispersion in the data, which we saw above. \n\nLooking at the AIC, the Negative Binomial Model has a lower AIC, 7464.1, than the Poisson model, 8852.5, indicating that it provides a better fit for the data. The Negative Binomial Model having a better fit makes sense given that the assumption of equal mean and variance is violated for the Poisson model. This means the Negative Binomial Model is better at capturing burglary reports in Chicago.\n\n\nPart 5 and 6 could not be completed as I continued to run into an error in step 5. \n","srcMarkdownNoYaml":"\n# Crime Analysis in Chicago\n\n## Introduction\nThis lab looks into the correlation between 311 calls about street lights being out and burglaries. Lighting is often connected to people's perceptions on safety, people choose to walk a certain way at night because there are more street lights which enable them to see. I wanted to see how this perception of safety connects to burglary calls.  \n\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n\n# Load required packages\nlibrary(tidyverse)      # Data manipulation\nlibrary(sf)             # Spatial operations\nlibrary(here)           # Relative file paths\nlibrary(viridis)        # Color scales\nlibrary(terra)          # Raster operations (replaces 'raster')\nlibrary(spdep)          # Spatial dependence\nlibrary(FNN)            # Fast nearest neighbors\nlibrary(MASS)           # Negative binomial regression\nlibrary(patchwork)      # Plot composition (replaces grid/gridExtra)\nlibrary(knitr)          # Tables\nlibrary(kableExtra)     # Table formatting\nlibrary(classInt)       # Classification intervals\nlibrary(here)\nlibrary(dplyr)\nlibrary(ggplot2)\n\n\n# Spatstat split into sub-packages\nlibrary(spatstat.geom)    # Spatial geometries\nlibrary(spatstat.explore) # Spatial exploration/KDE\n\n# Set options\noptions(scipen = 999)  # No scientific notation\nset.seed(5080)         # Reproducibility\n\n# Create consistent theme for visualizations\ntheme_crime <- function(base_size = 11) {\n  theme_minimal(base_size = base_size) +\n    theme(\n      plot.title = element_text(face = \"bold\", size = base_size + 1),\n      plot.subtitle = element_text(color = \"gray30\", size = base_size - 1),\n      legend.position = \"right\",\n      panel.grid.minor = element_blank(),\n      axis.text = element_blank(),\n      axis.title = element_blank()\n    )\n}\n\n# Set as default\ntheme_set(theme_crime())\n\ncat(\"✓ All packages loaded successfully!\\n\")\ncat(\"✓ Working directory:\", getwd(), \"\\n\")\n\n```\n\nAbove section loads in necessary packages to allow for functions to run, placing this at the beginning of the document helps it remain organized. \n\n\n## Chicago Spatial Data \n```{r spatial data}\n\n# Load police districts (used for spatial cross-validation)\npoliceDistricts <- \n  st_read(\"https://data.cityofchicago.org/api/geospatial/24zt-jpfn?method=export&format=GeoJSON\") %>%\n  st_transform('ESRI:102271') %>%\n  dplyr::select(District = dist_num)\n\n# Load police beats (smaller administrative units)\npoliceBeats <- \n  st_read(\"https://data.cityofchicago.org/api/geospatial/n9it-hstw?method=export&format=GeoJSON\") %>%\n  st_transform('ESRI:102271') %>%\n  dplyr::select(Beat = beat_num)\n\n# Load Chicago boundary\nchicagoBoundary <- \n  st_read(\"https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/DATA/Chapter5/chicagoBoundary.geojson\") %>%\n  st_transform('ESRI:102271')\n\ncat(\"✓ Loaded spatial boundaries\\n\")\ncat(\"  - Police districts:\", nrow(policeDistricts), \"\\n\")\ncat(\"  - Police beats:\", nrow(policeBeats), \"\\n\")\n\n\n```\n\n##Loaded in Chicago Spatial data \nThe coordinate reference system is set to 'ESRI:102271' (Illinois State Plane East) because it minimizes distortion since all the data we are looking at is in Chicago. Additionally, since Chicago is in the US which feet as a system of measurement it removes the need to convert units and minimizes confusion and error in distance calculations.\n\n## Burglary Data\n```{r burglary data}\n\n# Load from provided data file (downloaded from Chicago open data portal)\n\nburglaries <- st_read(here(\"data\", \"burglaries.shp\"))\nburglaries <- st_transform(burglaries, crs = 'ESRI:102271')\n\n\n# Check the data\ncat(\"\\n✓ Loaded burglary data\\n\")\ncat(\"  - Number of burglaries:\", nrow(burglaries), \"\\n\")\ncat(\"  - CRS:\", st_crs(burglaries)$input, \"\\n\")\ncat(\"  - Date range:\", min(burglaries$date, na.rm = TRUE), \"to\", \n    max(burglaries$date, na.rm = TRUE), \"\\n\")\n\n\n```\nThere are 7482 burglaries in the data set and the CRS is also set to Chicago which is useful for later calculations that check distance. If the datasets used different coordinate reference systems then problems would arise later when calculating distance. It is important to understand that while there are 7482 burglaries the spatial distribution of these is likely unequal and reflects where crime is surveilled rather than only where crime occurs. \n\n## Visualize point data\n```{r visualize point data}\n\n# Simple point map\np1 <- ggplot() + \n  geom_sf(data = chicagoBoundary, fill = \"gray95\", color = \"gray60\") +\n  geom_sf(data = burglaries, color = \"#d62828\", size = 0.1, alpha = 0.4) +\n  labs(\n    title = \"Burglary Locations\",\n    subtitle = paste0(\"Chicago 2017, n = \", nrow(burglaries))\n  )\n\n# Density surface using modern syntax\np2 <- ggplot() + \n  geom_sf(data = chicagoBoundary, fill = \"gray95\", color = \"gray60\") +\n  geom_density_2d_filled(\n    data = data.frame(st_coordinates(burglaries)),\n    aes(X, Y),\n    alpha = 0.7,\n    bins = 8\n  ) +\n  scale_fill_viridis_d(\n    option = \"plasma\",\n    direction = -1,\n    guide = \"none\"  # Modern ggplot2 syntax (not guide = FALSE)\n  ) +\n  labs(\n    title = \"Density Surface\",\n    subtitle = \"Kernel density estimation\"\n  )\n\n# Combine plots using patchwork (modern approach)\np1 + p2 + \n  plot_annotation(\n    title = \"Spatial Distribution of Burglaries in Chicago\",\n    tag_levels = 'A'\n  )\n```\n\n\nBurglaries are not evenly distributed across Chicago, they are more frequent on the South Side of Chicago. There is also a high concentration on the Northeast side. The South Side of Chicago has a reputation for being dangerous which could result in an increased police presense as well as an increase in willingness to report the crimes here. \n\n## Create the Fishnet\n```{r create fishnet}\n\n# Create 500m x 500m grid\nfishnet <- st_make_grid(\n  chicagoBoundary,\n  cellsize = 500,  # 500 meters per cell\n  square = TRUE\n) %>%\n  st_sf() %>%\n  mutate(uniqueID = row_number())\n\n# Keep only cells that intersect Chicago\nfishnet <- fishnet[chicagoBoundary, ]\n\n# View basic info\ncat(\"✓ Created fishnet grid\\n\")\ncat(\"  - Number of cells:\", nrow(fishnet), \"\\n\")\ncat(\"  - Cell size:\", 500, \"x\", 500, \"meters\\n\")\ncat(\"  - Cell area:\", round(st_area(fishnet[1,])), \"square meters\\n\")\n\n```\nThe step above creates a fishnet grid which turns the point data into a grid of cells. Creating a grid provides a uniform unit of analysis so that one can aggregate counts, calculate spatial features and run regression models. Existing boundaries like neighborhoods and census tracts change which could result an added step when comparing years. Neighborhood boundaries are particularly harder to use because not everyone agrees on where a neighborhood begins and ends. While this approach helps with standardization it is harder to understand where burglaries occur (such as which neighborhood) because the grid does not delineate this. Thus, it requires a degree of familiarity with the area and where neighborhoods are to understand how social interactions influence the observations from the data. \n\n## Aggregate Burglaries to Grid\n```{r aggregate-burglaries}\n# Spatial join: which cell contains each burglary?\nburglaries_fishnet <- st_join(burglaries, fishnet, join = st_within) %>%\n  st_drop_geometry() %>%\n  group_by(uniqueID) %>%\n  summarize(countBurglaries = n())\n\n# Join back to fishnet (cells with 0 burglaries will be NA)\nfishnet <- fishnet %>%\n  left_join(burglaries_fishnet, by = \"uniqueID\") %>%\n  mutate(countBurglaries = replace_na(countBurglaries, 0))\n\n# Summary statistics\ncat(\"\\nBurglary count distribution:\\n\")\nsummary(fishnet$countBurglaries)\ncat(\"\\nCells with zero burglaries:\", \n    sum(fishnet$countBurglaries == 0), \n    \"/\", nrow(fishnet),\n    \"(\", round(100 * sum(fishnet$countBurglaries == 0) / nrow(fishnet), 1), \"%)\\n\")\n\n```\n\n\n```{r visualize-fishnet}\n#| fig-width: 8\n#| fig-height: 6\n\n# Visualize aggregated counts\nggplot() +\n  geom_sf(data = fishnet, aes(fill = countBurglaries), color = NA) +\n  geom_sf(data = chicagoBoundary, fill = NA, color = \"white\", linewidth = 1) +\n  scale_fill_viridis_c(\n    name = \"Burglaries\",\n    option = \"plasma\",\n    trans = \"sqrt\",  # Square root for better visualization of skewed data\n    breaks = c(0, 1, 5, 10, 20, 40)\n  ) +\n  labs(\n    title = \"Burglary Counts by Grid Cell\",\n    subtitle = \"500m x 500m cells, Chicago 2017\"\n  ) +\n  theme_crime()\n\n\n```\n\nBurglaries are more dispersed in the South Side and in the core of the North. The largest cluster of cells with zero burglaries is also on the South Side. \n\n\n## Kernal Density Basemap\n```{r kde-baseline}\n#| message: false\n\n# Convert burglaries to ppp (point pattern) format for spatstat\nburglaries_ppp <- as.ppp(\n  st_coordinates(burglaries),\n  W = as.owin(st_bbox(chicagoBoundary))\n)\n\n# Calculate KDE with 1km bandwidth\nkde_burglaries <- density.ppp(\n  burglaries_ppp,\n  sigma = 1000,  # 1km bandwidth\n  edge = TRUE    # Edge correction\n)\n\n# Convert to terra raster (modern approach, not raster::raster)\nkde_raster <- rast(kde_burglaries)\n\n# Extract KDE values to fishnet cells\nfishnet <- fishnet %>%\n  mutate(\n    kde_value = terra::extract(\n      kde_raster,\n      vect(fishnet),\n      fun = mean,\n      na.rm = TRUE\n    )[, 2]  # Extract just the values column\n  )\n\ncat(\"✓ Calculated KDE baseline\\n\")\n\n```\n\n\n```{r visualize-kde}\n#| fig-width: 8\n#| fig-height: 6\n\nggplot() +\n  geom_sf(data = fishnet, aes(fill = kde_value), color = NA) +\n  geom_sf(data = chicagoBoundary, fill = NA, color = \"white\", linewidth = 1) +\n  scale_fill_viridis_c(\n    name = \"KDE Value\",\n    option = \"plasma\"\n  ) +\n  labs(\n    title = \"Kernel Density Estimation Baseline\",\n    subtitle = \"Simple spatial smoothing of burglary locations\"\n  ) +\n  theme_crime()\n\n```\n\n\nThe above map looks very similar to the other patterns of crime in Chicago because a KDE baseline looks as what happens if an incident, in this case burglaries happens where they did before. This map counts the clusters of incidents well.\n\n## Spatial predictor variables\n```{r spatial predictor var}\n\nstreetLights_allOut <- read_csv(here(\"data/311_Service_Requests_-_Street_Lights_-_All_Out_-_Historical_20251112.csv\"))%>%\n  filter(!is.na(Latitude), !is.na(Longitude)) %>%\n  st_as_sf(coords = c(\"Longitude\", \"Latitude\"), crs = 4326) %>%\n  st_transform('ESRI:102271')\n\n#cat(\"✓ Loaded street vehicle calls\\n\")\ncat(\"  - Number of calls:\", nrow(streetLights_allOut), \"\\n\")\n\n\"data/311_Service_Requests_-_Street_Lights_-_All_Out_-_Historical_20251112.csv\"\n\n```\n\n\n## Count of Street Lights all out per cell\n```{r countstreetLights_allOut}\n# Aggregate lights out to fishnet\nlights_fishnet <- st_join(streetLights_allOut, fishnet, join = st_within) %>%\n  st_drop_geometry() %>%\n  group_by(uniqueID) %>%\n  summarize(streetLights_allOut = n())\n\n# Join to fishnet\nfishnet <- fishnet %>%\n  left_join(lights_fishnet, by = \"uniqueID\") %>%\n  mutate(streetLights_allOut = replace_na(streetLights_allOut, 0))\n\ncat(\"All lights out distribution:\\n\")\nsummary(fishnet$streetLights_allOut)\n```\n\n\n\n```{r visualize-streetlights-allout}\n#| fig-width: 10\n#| fig-height: 4\n\np1 <- ggplot() +\n  geom_sf(data = fishnet, aes(fill = streetLights_allOut), color = NA) +\n  scale_fill_viridis_c(name = \"Count\", option = \"magma\") +\n  labs(title = \"All Lights Out 311 Calls\") +\n  theme_crime()\n\np2 <- ggplot() +\n  geom_sf(data = fishnet, aes(fill = countBurglaries), color = NA) +\n  scale_fill_viridis_c(name = \"Count\", option = \"plasma\") +\n  labs(title = \"Burglaries\") +\n  theme_crime()\n\np1 + p2 +\n  plot_annotation(title = \"Are street lights out and burglaries correlated?\")\n\n```\n\n\nIn this section I pulled data from Chicago's Open Data portal for 311 calls on street lights that are all out. Visually there are similarities between where burglairies occur and where street lights are all out specifically on the South Side there is more difference between these two categories in the North. This suggests that where street lights are out could help predict burglaries, but more likely just implies perceptions of safety.\n\n## Nearest Neighbor \n\nHere we are calculating the mean distance to the 3 nearest blockw with all the lights out. \n\n```{r nn-feature}\n#| message: false\n\n# Calculate mean distance to 3 nearest lights out\n# (Do this OUTSIDE of mutate to avoid sf conflicts)\n\n# Get coordinates\nfishnet_coords <- st_coordinates(st_centroid(fishnet))\nlights_coords <- st_coordinates(streetLights_allOut)\n\n# Calculate k nearest neighbors and distances\nnn_result <- get.knnx(lights_coords, fishnet_coords, k = 3)\n\n# Add to fishnet\nfishnet <- fishnet %>%\n  mutate(\n    streetLights_allOut.nn = rowMeans(nn_result$nn.dist)\n  )\n\ncat(\"✓ Calculated nearest neighbor distances\\n\")\nsummary(fishnet$streetLights_allOut.nn)\n\n```\n\n\nA low value of streetLights_allOut.nn means means that the block is closer to other blocks with the lights out while a high value means that a cell is far from other cells with blocks that have the lights out. Blocks that have low value could indicate decreasing perceptions of safety. \n\n\n## Distance to Hot Spots\n```{r distance to hot spots}\n\n#used this for local_moran becuase when it saves fishnet as fishnet it aborts 2. dplyr mutate + sf can still corrupt the geometry column\n\ncoords <- st_coordinates(st_centroid(fishnet))\nneighbors <- knn2nb(knearneigh(coords, k = 5))\nweights <- nb2listw(neighbors, style = \"W\", zero.policy = TRUE)\n\nlocal_moran <- localmoran(fishnet[[\"streetLights_allOut\"]], weights)\nmean_val <- mean(fishnet[[\"streetLights_allOut\"]], na.rm = TRUE)\n\nfishnet$local_i <- local_moran[,1]\nfishnet$p_value <- local_moran[,5]\nfishnet$is_significant <- fishnet$p_value < 0.05\n\nmean_val <- mean(fishnet$streetLights_allOut, na.rm = TRUE)\n\nfishnet$moran_class <- dplyr::case_when(\n  !fishnet$is_significant ~ \"Not Significant\",\n  fishnet$local_i > 0 & fishnet$streetLights_allOut > mean_val ~ \"High-High\",\n  fishnet$local_i > 0 & fishnet$streetLights_allOut <= mean_val ~ \"Low-Low\",\n  fishnet$local_i < 0 & fishnet$streetLights_allOut > mean_val ~ \"High-Low\",\n  fishnet$local_i < 0 & fishnet$streetLights_allOut <= mean_val ~ \"Low-High\"\n)\n\n\n\n\n```\n\n\n```{r visualize-morans}\n#| fig-width: 8\n#| fig-height: 6\n\n# Visualize hot spots\nggplot() +\n  geom_sf(\n    data = fishnet, \n    aes(fill = moran_class), \n    color = NA\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"High-High\" = \"#d7191c\",\n      \"High-Low\" = \"#fdae61\",\n      \"Low-High\" = \"#abd9e9\",\n      \"Low-Low\" = \"#2c7bb6\",\n      \"Not Significant\" = \"gray90\"\n    ),\n    name = \"Cluster Type\"\n  ) +\n  labs(\n    title = \"Local Moran's I: Lights Out Clusters\",\n    subtitle = \"High-High = Hot spots of disorder\"\n  ) +\n  theme_crime()\n\n#fill= moran_class is not running \n\n```\n\nThe distance to a cluster of lights that are out are helpful because it shows local spatial density while only looking at the distance to one specific point could be a random incident. From the distribution there are no areas with a high-low distribution and few areas with a low-high distribution. Low-low distributions, which are cold spots few lights are out and next to people without lights out, are clustered in the Southeast corner of Chicago, with patches around the boundary of the city. This means there are low values and its surrounded by other low values. High-high clusters are in the center of Chicago suggests that the observations are part of a cluster of high values and surrounded by high values i.e. street light blocks are out and they are next to other areas with street lights that are out. One thing to keep in mind is that the boundaries of Chicago have fewer neighbors thus this could bias the results and result with the spatial outliers such as high-low results. \n\n```{r distance-to-hotspots}\n# Get centroids of \"High-High\" cells (hot spots)\nhotspots <- fishnet %>%\n  filter(moran_class == \"High-High\") %>%\n  st_centroid()\n\n# Calculate distance from each cell to nearest hot spot\nif (nrow(hotspots) > 0) {\n  fishnet <- fishnet %>%\n    mutate(\n      dist_to_hotspot = as.numeric(\n        st_distance(st_centroid(fishnet), hotspots %>% st_union())\n      )\n    )\n  \n  cat(\"✓ Calculated distance to abandoned car hot spots\\n\")\n  cat(\"  - Number of hot spot cells:\", nrow(hotspots), \"\\n\")\n} else {\n  fishnet <- fishnet %>%\n    mutate(dist_to_hotspot = 0)\n  cat(\"⚠ No significant hot spots found\\n\")\n}\n\n```\nThere are 297 hot spots.\n\n\n## Cross Validation \n```{r join-districts}\n# Join district information to fishnet\nfishnet <- st_join(\n  fishnet,\n  policeDistricts,\n  join = st_within,\n  left = TRUE\n) %>%\n  filter(!is.na(District))  # Remove cells outside districts\n\ncat(\"✓ Joined police districts\\n\")\ncat(\"  - Districts:\", length(unique(fishnet$District)), \"\\n\")\ncat(\"  - Cells:\", nrow(fishnet), \"\\n\")\n\n```\nPolice districts are used for the spatial cross-validation because we are using crime data.\n\n\n## Poisson Regression\n```{r prepare-data for Poisson}\n# Create clean modeling dataset\nfishnet_model <- fishnet %>%\n  st_drop_geometry() %>%\n  dplyr::select(\n    uniqueID,\n    District,\n    countBurglaries,\n    streetLights_allOut,\n    streetLights_allOut.nn,\n    dist_to_hotspot\n  ) %>%\n  na.omit()  # Remove any remaining NAs\n\ncat(\"✓ Prepared modeling data\\n\")\ncat(\"  - Observations:\", nrow(fishnet_model), \"\\n\")\ncat(\"  - Variables:\", ncol(fishnet_model), \"\\n\")\n\n```\nThere are 1708 observations and 6 variables. All of the values are positive because we are counting and cannot have a negative number.\n\n\n```{r poisson continued}\nfishnet_safe <- data.frame(\n  countBurglaries      = as.numeric(fishnet_model$countBurglaries),\n  streetLights_allOut  = as.numeric(fishnet_model$streetLights_allOut),\n  streetLights_allOut.nn = as.numeric(fishnet_model$streetLights_allOut.nn),\n  dist_to_hotspot      = as.numeric(fishnet_model$dist_to_hotspot)\n)\n\n# Remove row.names just in case\nrownames(fishnet_safe) <- NULL\n\n# Confirm attributes might not need attributes through glm just need to write.csv so could delete\nattributes(fishnet_safe)\n\nglm(countBurglaries ~ streetLights_allOut, data = fishnet_safe, family = poisson())\nglm(countBurglaries ~ streetLights_allOut.nn, data = fishnet_safe, family = poisson())\nglm(countBurglaries ~ dist_to_hotspot, data = fishnet_safe, family = poisson())\nglm(countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n    data = fishnet_safe, family = poisson())\n\nwrite.csv(fishnet_safe, \"fishnet_safe.csv\", row.names = FALSE)\nfishnet_reload <- read.csv(\"fishnet_safe.csv\")\n\nglm(countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n    data = fishnet_reload, family = poisson())\n\n\nlibrary(speedglm)\n\n\nmodel_poisson <- speedglm(\n  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n  data = fishnet_reload,\n  family = poisson()\n)\n\nsummary(model_poisson)\n\n```\n\nThe Poisson regression results indicate that burglary counts are significantly associated with street lighting conditions and proximity to known hotspots. Blocks with more streetlights out tend to experience slightly higher numbers of burglaries, while blocks that are farther from other lights-out blocks have lower expected burglary counts, suggesting that clusters of poorly lit areas are more vulnerable. Additionally, blocks located closer to established burglary hotspots are at greater risk. All three predictors—total street lights out (12.91), mean distance to other lights-out blocks (-19.1), and distance to hotspots (-10.72) are highly significant based on their values. The model shows that areas with less lighting are more likely to be near areas where more burglary is reported.\n\n```{r check-overdispersion}\n# Calculate dispersion parameter\ndf_resid <- nrow(fishnet_reload) - length(model_poisson$coefficients)\n\ndispersion <- model_poisson$deviance / df_resid\ndispersion\n\nif (dispersion > 1.5) {\n  cat(\"⚠ Overdispersion detected! Consider Negative Binomial model.\\n\")\n} else {\n  cat(\"✓ Dispersion looks okay for Poisson model.\\n\")\n}\n```\nOverdispersion is detected which means the variance of the response variable exceeds it's mean, which is an assumption in the Poisson distribution. \n\n## Negative Binomial Regression \n```{r fit-negbin}\n\n##ALternative way to get negative binomial regression\n\n# Fit NB using Poisson coefficients as starting values\npoisson_coefs <- coef(glm(\n  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n  data = fishnet_reload,\n  family = poisson()\n))\n\nmodel_nb <- glm.nb(\n  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,\n  data = fishnet_reload,\n  init.theta = 1,               # initial theta\n  control = glm.control(maxit = 100, epsilon = 1e-8),\n  start = poisson_coefs         # start from Poisson estimates\n)\nsummary(model_nb)\n\ncat(\"\\nModel Comparison:\\n\")\ncat(\"Poisson AIC:\", round(AIC(model_poisson), 1), \"\\n\")\ncat(\"Negative Binomial AIC:\", round(AIC(model_nb), 1), \"\\n\")\n\n```\n\nThe negative binomial regression results show that all three predictors are highly significant, which is consistent with the Poisson model. More streetlights out is associated with higher burglary counts, greater distance to other lights-out blocks is associated with fewer burglaries, and closer proximity to a hotspot increases burglary risk. The negative binomial model accounts for overdispersion in the data, which we saw above. \n\nLooking at the AIC, the Negative Binomial Model has a lower AIC, 7464.1, than the Poisson model, 8852.5, indicating that it provides a better fit for the data. The Negative Binomial Model having a better fit makes sense given that the assumption of equal mean and variance is violated for the Poisson model. This means the Negative Binomial Model is better at capturing burglary reports in Chicago.\n\n\nPart 5 and 6 could not be completed as I continued to run into an error in step 5. \n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"Lab4_IxchelRamirez.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","theme":"cosmo","title":"Lab4","author":"Ixchel Ramirez","date":"2025-11-17"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}