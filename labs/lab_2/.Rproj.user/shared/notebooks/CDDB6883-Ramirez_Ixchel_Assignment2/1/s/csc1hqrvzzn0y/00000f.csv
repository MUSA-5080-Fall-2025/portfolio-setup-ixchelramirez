"0","# Use projected CRS in feet"
"0","target_crs <- 2272  # Pennsylvania South (ft)"
"0","pa_tracts_vulnerable_proj <- st_transform(pa_tracts_vulnerable, target_crs)"
"0","hospitals_proj <- st_transform(hospitals, target_crs)"
"0",""
"0","# Compute centroids of vulnerable tracts"
"0","tract_vuln <- st_centroid(pa_tracts_vulnerable_proj) %>% filter(vulnerable)"
"0",""
"0","# Find nearest hospital for each vulnerable tract"
"0","nearest_hospital_index <- st_nearest_feature(tract_vuln, hospitals_proj)"
"0","nearest_hospitals <- hospitals_proj[nearest_hospital_index, ]"
"0",""
"0","# Compute distances in feet, convert to miles"
"0","dist_ft <- st_distance(tract_vuln, nearest_hospitals, by_element = TRUE)"
"0","tract_vuln$dist_to_hospital_miles <- as.numeric(dist_ft) / 5280"
"0",""
"0","# Summarize distances"
"0","avg_dist <- mean(tract_vuln$dist_to_hospital_miles, na.rm = TRUE)"
"0","max_dist <- max(tract_vuln$dist_to_hospital_miles, na.rm = TRUE)"
"0","over15 <- sum(tract_vuln$dist_to_hospital_miles > 15, na.rm = TRUE)"
"0",""
"0","cat(""Average distance to nearest hospital (miles):"", round(avg_dist, 2), ""\n"")"
"1","Average distance to nearest hospital (miles):"
"1"," "
"1","3.1"
"1"," "
"1","
"
"0","cat(""Maximum distance (miles):"", round(max_dist, 2), ""\n"")"
"1","Maximum distance (miles):"
"1"," "
"1","25.62"
"1"," "
"1","
"
"0","cat(""Number of vulnerable tracts >15 miles from nearest hospital:"", over15, ""\n"")"
"1","Number of vulnerable tracts >15 miles from nearest hospital:"
"1"," "
"1","22"
"1"," "
"1","
"
