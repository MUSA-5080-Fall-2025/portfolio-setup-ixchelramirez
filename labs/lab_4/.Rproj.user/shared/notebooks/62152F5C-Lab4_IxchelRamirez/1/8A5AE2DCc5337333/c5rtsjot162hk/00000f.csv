"0",""
"0","##ALternative way to get negative binomial regression"
"0",""
"0","# Fit NB using Poisson coefficients as starting values"
"0","poisson_coefs <- coef(glm("
"0","  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,"
"0","  data = fishnet_reload,"
"0","  family = poisson()"
"0","))"
"0",""
"0","model_nb <- glm.nb("
"0","  countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + dist_to_hotspot,"
"0","  data = fishnet_reload,"
"0","  init.theta = 1,               # initial theta"
"0","  control = glm.control(maxit = 100, epsilon = 1e-8),"
"0","  start = poisson_coefs         # start from Poisson estimates"
"0",")"
"0","summary(model_nb)"
"1","
Call:
"
"1",""
"1","glm.nb(formula = countBurglaries ~ streetLights_allOut + streetLights_allOut.nn + 
    dist_to_hotspot, data = fishnet_reload, start = poisson_coefs, 
    control = glm.control(maxit = 100, epsilon = 0.00000001), 
    init.theta = 1.743746675, link = log)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                      "
"1","    Estimate"
"1","  Std. Error"
"1"," z value"
"1","             Pr(>|z|)"
"1","    "
"1","
(Intercept)           "
"1","  1.57250588"
"1","  0.08224961"
"1","  19.119"
"1"," < 0.0000000000000002"
"1"," ***"
"1","
streetLights_allOut   "
"1","  0.00218895"
"1","  0.00027911"
"1","   7.843"
"1","  0.00000000000000441"
"1"," ***"
"1","
streetLights_allOut.nn"
"1"," -0.00888123"
"1","  0.00061115"
"1"," -14.532"
"1"," < 0.0000000000000002"
"1"," ***"
"1","
dist_to_hotspot       "
"1"," -0.00007061"
"1","  0.00001352"
"1","  -5.223"
"1","  0.00000017591941882"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","Negative Binomial(1.7437)"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 2647.3  on 1707  degrees of freedom
"
"1",""
"1","Residual deviance: 1818.0  on 1704  degrees of freedom
"
"1","AIC: "
"1",""
"1","7464.1"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","1"
"1",""
"1","
"
"1","
"
"1","
              Theta: "
"1"," "
"1","1.744"
"1"," "
"1","
          Std. Err.: "
"1"," "
"1","0.101"
"1"," "
"1","
"
"1","
 2 x log-likelihood: "
"1"," "
"1","-7454.085"
"1"," "
"1","
"
"0","cat(""\nModel Comparison:\n"")"
"1","
Model Comparison:
"
"0","cat(""Poisson AIC:"", round(AIC(model_poisson), 1), ""\n"")"
"1","Poisson AIC:"
"1"," "
"1","8852.5"
"1"," "
"1","
"
"0","cat(""Negative Binomial AIC:"", round(AIC(model_nb), 1), ""\n"")"
"1","Negative Binomial AIC:"
"1"," "
"1","7464.1"
"1"," "
"1","
"
