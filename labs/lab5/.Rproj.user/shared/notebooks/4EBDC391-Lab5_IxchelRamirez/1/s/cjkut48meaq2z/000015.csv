"0","# Calculate MAE by station"
"0","station_errors <- test %>%"
"0","  group_by(start_station, start_lat.x, start_lon.y) %>%"
"0","  summarize("
"0","    MAE = mean(abs_error, na.rm = TRUE),"
"0","    avg_demand = mean(Trip_Count, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  filter(!is.na(start_lat.x), !is.na(start_lon.y))"
"0",""
"0","## Create Two Maps Side-by-Side with Proper Legends (sorry these maps are ugly)"
"0",""
"0","# Calculate station errors"
"0","station_errors <- test %>%"
"0","  filter(!is.na(pred2)) %>%"
"0","  group_by(start_station, start_lat.x, start_lon.y) %>%"
"0","  summarize("
"0","    MAE = mean(abs(Trip_Count - pred2), na.rm = TRUE),"
"0","    avg_demand = mean(Trip_Count, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  filter(!is.na(start_lat.x), !is.na(start_lon.y))"
"0",""
"0","# Map 1: Prediction Errors"
"0","p1 <- ggplot() +"
"0","  geom_sf(data = philly_census, fill = ""grey95"", color = ""white"", size = 0.2) +"
"0","  geom_point("
"0","    data = station_errors,"
"0","    aes(x = start_lon.y, y = start_lat.x, color = MAE),"
"0","    size = 3.5,"
"0","    alpha = 0.7"
"0","  ) +"
"0","  scale_color_viridis("
"0","    option = ""plasma"","
"0","    name = ""MAE\n(trips)"","
"0","    direction = -1,"
"0","    breaks = c(0.5, 1.0, 1.5),  # Fewer, cleaner breaks"
"0","    labels = c(""0.5"", ""1.0"", ""1.5"")"
"0","  ) +"
"0","  labs(title = ""Prediction Errors"","
"0","       subtitle = ""Higher in Center City"") +"
"0","  mapTheme +"
"0","  theme("
"0","    legend.position = ""right"","
"0","    legend.title = element_text(size = 10, face = ""bold""),"
"0","    legend.text = element_text(size = 9),"
"0","    plot.title = element_text(size = 14, face = ""bold""),"
"0","    plot.subtitle = element_text(size = 10)"
"0","  ) +"
"0","  guides(color = guide_colorbar("
"0","    barwidth = 1.5,"
"0","    barheight = 12,"
"0","    title.position = ""top"","
"0","    title.hjust = 0.5"
"0","  ))"
"0",""
"0","# Map 2: Average Demand"
"0","p2 <- ggplot() +"
"0","  geom_sf(data = philly_census, fill = ""grey95"", color = ""white"", size = 0.2) +"
"0","  geom_point("
"0","    data = station_errors,"
"0","    aes(x = start_lon.y, y = start_lat.x, color = avg_demand),"
"0","    size = 3.5,"
"0","    alpha = 0.7"
"0","  ) +"
"0","  scale_color_viridis("
"0","    option = ""viridis"","
"0","    name = ""Avg\nDemand"","
"0","    direction = -1,"
"0","    breaks = c(0.5, 1.0, 1.5, 2.0, 2.5),  # Clear breaks"
"0","    labels = c(""0.5"", ""1.0"", ""1.5"", ""2.0"", ""2.5"")"
"0","  ) +"
"0","  labs(title = ""Average Demand"","
"0","       subtitle = ""Trips per station-hour"") +"
"0","  mapTheme +"
"0","  theme("
"0","    legend.position = ""right"","
"0","    legend.title = element_text(size = 10, face = ""bold""),"
"0","    legend.text = element_text(size = 9),"
"0","    plot.title = element_text(size = 14, face = ""bold""),"
"0","    plot.subtitle = element_text(size = 10)"
"0","  ) +"
"0","  guides(color = guide_colorbar("
"0","    barwidth = 1.5,"
"0","    barheight = 12,"
"0","    title.position = ""top"","
"0","    title.hjust = 0.5"
"0","  ))"
"0",""
"0","# Combine with better layout"
"0","library(gridExtra)"
"0","grid.arrange("
"0","  p1, p2, "
"0","  ncol = 2,"
"0","  top = textGrob("
"0","    ""Model 2 Performance: Errors vs. Demand Patterns"","
"0","    gp = gpar(fontsize = 16, fontface = ""bold"")"
"0","  )"
"0",")"
