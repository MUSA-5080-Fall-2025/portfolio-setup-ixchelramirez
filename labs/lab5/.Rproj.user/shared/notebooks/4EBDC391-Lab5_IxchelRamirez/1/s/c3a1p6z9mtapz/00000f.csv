"0","model2_baseline <- lm("
"0","  Trip_Count ~ as.factor(hour) + dotw_simple +"
"0","    Temperature + Precipitation +"
"0","    lag1Hour + lag3Hours + lag1day,"
"0","  data = train"
"0",")"
"0",""
"0","model2_enhanced <- lm("
"0","  Trip_Count ~ as.factor(hour) + dotw_simple +"
"0","    Temperature + Precipitation +"
"0","    lag1Hour + lag3Hours + lag1day +"
"0","    center_city_high_demand + perfect_weather,"
"0","  data = train"
"0",")"
"0",""
"0","cat(""\n=== MODEL 2 ENHANCED ===\n"")"
"1","
=== MODEL 2 ENHANCED ===
"
"0","cat(""R-squared:"", round(summary(model2_enhanced)$r.squared, 4), ""\n"")"
"1","R-squared:"
"1"," "
"1","0.3648"
"1"," "
"1","
"
"0","cat(""Adj R-squared:"", round(summary(model2_enhanced)$adj.r.squared, 4), ""\n"")"
"1","Adj R-squared:"
"1"," "
"1","0.3648"
"1"," "
"1","
"
"0","# Show improvement"
"0","r2_improvement <- summary(model2_enhanced)$r.squared - summary(model2_baseline)$r.squared"
"0","cat(""\nR-squared improvement:"", round(r2_improvement, 4), "
"0","    paste0(""(+"", round(r2_improvement * 100, 2), ""%)""), ""\n"")"
"1","
R-squared improvement:"
"1"," "
"1","0.0077"
"1"," "
"1","(+0.77%)"
"1"," "
"1","
"
"0","# Baseline linear model"
"0","test <- test %>%"
"0","  mutate("
"0","    pred_baseline = predict(model2_baseline, newdata = .),"
"0","    pred_enhanced = predict(model2_enhanced, newdata = .)"
"0","  )"
"0",""
"0","test <- test %>%"
"0","  mutate("
"0","    abs_error_baseline = abs(Trip_Count - pred_baseline),"
"0","    abs_error_enhanced = abs(Trip_Count - pred_enhanced)"
"0","  )"
"0",""
"0","mae_baseline <- mean(test$abs_error_baseline, na.rm = TRUE)"
"0","mae_enhanced <- mean(test$abs_error_enhanced, na.rm = TRUE)"
"0",""
"0","cat(""MAE Baseline LM:"", round(mae_baseline, 3), ""\n"")"
"1","MAE Baseline LM:"
"1"," "
"1","0.62"
"1"," "
"1","
"
"0","cat(""MAE Enhanced LM:"", round(mae_enhanced, 3), ""\n"")"
"1","MAE Enhanced LM:"
"1"," "
"1","0.622"
"1"," "
"1","
"
